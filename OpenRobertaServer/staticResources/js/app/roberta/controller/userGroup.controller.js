define(["require","exports","message","util.roberta","userGroup.model","guiState.controller","language.controller","jquery","blockly","bootstrap-table","bootstrap-tagsinput"],(function(e,t,a,s,r,o,n,i,l){var d,u;Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.showPanel=void 0;var c=99,m={};function p(){d.bootstrapTable("showLoading"),r.loadUserGroupList((function(e){"ok"===e.rc?d.bootstrapTable("load",e.userGroups):(d.bootstrapTable("removeAll"),a.displayInformation(e,e.cause,e.cause)),setTimeout((function(){d.bootstrapTable("resetView",{height:s.calcDataTableHeight()}),d.find('[data-bs-toggle="tooltip"]').tooltip(),d.bootstrapTable("hideLoading")}),250)})),i("#tabUserGroupList").tabWrapShow(),"tabUserGroupList"!==o.getView()&&o.setView("tabUserGroupList")}function f(e){if(null!=e&&"string"==typeof e.name){i("#userGroupMemberListHeader").html(e.name.trim()||"&nbsp;"),i("#additionalMembersInput").val("");var t=e.members.map((function(e){return e}));t.push({id:0,account:"",hasDefaultPassword:!1}),u.bootstrapTable("showLoading"),u.bootstrapTable("removeAll"),u.bootstrapTable("load",t),m={},setTimeout((function(){u.bootstrapTable("resetView",{height:s.calcDataTableHeight()}),u.bootstrapTable("hideLoading")}),250),i("#tabUserGroupMemberList").tabWrapShow()}else a.displayPopupMessage("ORA_GROUP_GET_MEMBERS_ERROR","Could not open group detail view for that group.","OK")}t.showPanel=p,t.init=function(){var e,t,b,g,R,h,_,E,M;d=i("#userGroupTable"),u=i("#userGroupMemberTable"),(e=d.find(".action-items-template")).remove(),d.bootstrapTable({locale:o.getLanguage(),height:s.calcDataTableHeight(),pageList:"[ 10, 25, All ]",toolbar:"#userGroupListToolbar",theadClasses:"table-dark",showRefresh:!0,sortName:"created",sortOrder:"desc",showPaginationSwitch:!0,pagination:!0,buttonsAlign:"right",buttons:{btnGroupAdd:{html:'<button class="btn btn-secondary" id="showCreateUserGroupPopup" title="'+l.Msg.USERGROUP_CREATE_TOOLTIP+'" type="button" name="btnGroupAdd"><i class="typcn typcn-plus"></i> </button>'}},resizable:!0,iconsPrefix:"typcn",icons:{paginationSwitchDown:"typcn-document-text",paginationSwitchUp:"typcn-book",refresh:"typcn-refresh"},columns:[{title:"<span lkey='Blockly.Msg.DATATABLE_USERGROUP_NAME'>"+(l.Msg.DATATABLE_USERGROUP_NAME||"Name der Gruppe")+"</span>",field:"name",sortable:!0},{title:"<span lkey='Blockly.Msg.DATATABLE_MEMBERS'>"+(l.Msg.DATATABLE_MEMBERS||"Mitglieder")+"</span>",field:"members",sortable:!0,sorter:function(e,t){return(e.length||0)-(t.length||0)},formatter:function(e,t,a){return e.length||0}},{title:"<span lkey='Blockly.Msg.DATATABLE_SHARED_PROGRAMS'>"+(l.Msg.DATATABLE_SHARED_PROGRAMS||"Geteilte Programme")+"</span>",field:"programs",sortable:!1,formatter:function(e,t,a){if(!e||!e.length){var s=i('<div><span lkey="Blockly.Msg.SHARE_PROGRAMS_USERGROUP_HINT" data-translation-targets="title" data-bs-toggle="tooltip" data-container="body" data-placement="right" title="">-</span></div>');return n.translate(s),s.html()}var r=function(e){var t="";"READ"===e.right?t="eye":"X_WRITE"===e.right?t="key":"WRITE"===e.right&&(t="pencil");var a=i('<div><span><span class="typcn typcn-'+e.robot+'"></span> <span class="typcn typcn-'+t+'"></span> '+e.name+"</span></div>");return n.translate(a),a.html()};if(1===e.length)return r(e[0]);var o=e.map((function(e){return r(e)}));return s=i('<div><div style="white-space:nowrap;"><span style="float:left;">'+o.shift()+'</span><a class="collapsed showRelations" href="#" style="float:right;" href="#" data-bs-toggle="collapse" data-bs-target=".relation'+a+'"></a></div>'+o.map((function(e){return'<div style="clear:both;" class="collapse relation'+a+'"> '+e+"</div>"})).join("")+"</div>"),n.translate(s),s.html()},events:{"click .showRelations":function(e,t,a,s){e.stopPropagation(),i(".relation"+s).collapse("toggle")}}},{title:"<span lkey='Blockly.Msg.DATATABLE_CREATED_ON'>"+(l.Msg.DATATABLE_CREATED_ON||"Erzeugt am")+"</span>",field:"created",sortable:!0,formatter:s.formatDate},{checkbox:!0,valign:"middle"},{title:'<a href="#" id="deleteUserGroups" class="deleteSome disabled" rel="tooltip" lkey="Blockly.Msg.USERGROUP_LIST_DELETE_ALL_TOOLTIP" data-bs-original-title="" data-container="body" title="" data-translation-targets="title data-bs-original-title"><span class="typcn typcn-delete"></span></a>',events:{"click .delete":function(e,t,o,n){e.stopPropagation();var u=void 0===typeof o.name?null:o.name,c=void 0===typeof o.members?[]:o.members,m=i(this),p=function(){r.deleteUserGroup(o.name,(function(e){"ok"===e.rc?d.bootstrapTable("remove",{field:"name",values:[o.name]}):s.showMsgOnTop(e.message)}))};if(null!==u&&!m.hasClass("disabled"))if(c.length)if(0===c.filter((function(e){return!e.hasDefaultPassword})).length){var f="USERGROUP_DELETE_WITH_MEMBERS_WARNING",b=l.Msg[f]||"Are your sure that you want to delete the usergroup including all members? No member did log in so far.";i("#show-message-confirm").oneWrap("shown.bs.modal",(function(e){i("#confirm").off(),i("#confirm").onWrap("click",(function(e){e.preventDefault(),p(!0)})),i("#confirmCancel").off(),i("#confirmCancel").onWrap("click",(function(e){e.preventDefault(),i(".modal").modal("hide")}))})),a.displayPopupMessage(f,b,"OK",l.Msg.POPUP_CANCEL)}else s.showMsgOnTop("ORA_GROUP_DELETE_ERROR_GROUP_HAS_MEMBERS");else p()}},align:"left",valign:"top",formatter:function(t,a,s){return e.find("td").html()},width:"117px"}]}),i("#userGroupList").find('[data-bs-toggle="tooltip"]').tooltip(),d.bootstrapTable("togglePagination"),n.translate(i("#userGroupList")),t=d.closest("#userGroupList"),i("#tabUserGroupList").onWrap("shown.bs.tab",(function(){return p(),!1}),"tutorial clicked"),i(window).resize((function(){d.bootstrapTable("resetView",{height:s.calcDataTableHeight()})})),t.find('[data-bs-toggle="tooltip"]').tooltip(),i("#create-user-group").find('[data-bs-toggle="tooltip"]').tooltip(),t.find('button[name="refresh"]').onWrap("click",(function(e){e.preventDefault(),p()}),"refreshed usergroup view"),d.onWrap("check-all.bs.table",(function(e,a){t.find(".deleteSome").removeClass("disabled"),d.find(".delete").addClass("disabled")}),"check all usergroups"),d.onWrap("check.bs.table",(function(e,a){t.find(".deleteSome").removeClass("disabled"),d.find(".delete").addClass("disabled")}),"check one usergroup"),d.onWrap("uncheck-all.bs.table",(function(e,a){t.find(".deleteSome").addClass("disabled"),d.find(".delete").filter(':not([data-status="disabled"])').removeClass("disabled")}),"uncheck all usergroups"),d.onWrap("uncheck.bs.table",(function(e,a){var s=d.bootstrapTable("getSelections");s&&0!==s.length||(t.find(".deleteSome").addClass("disabled"),d.find(".delete").filter(':not([data-status="disabled"])').removeClass("disabled"))}),"uncheck one usergroup"),t.find(".deleteSome").onWrap("click",(function(){var e=d.bootstrapTable("getSelections"),o=t.find(".deleteSome");if(e&&0!==e.length&&!o.hasClass("disabled")){var n=e.map((function(e){return e.name}));if(e.reduce((function(e,t){return e||t&&t.members&&t.members.length>0}),!1))if(e.reduce((function(e,t){return e||t&&t.members&&t.members.filter((function(e){return!e.hasDefaultPassword})).length>0}),!1))a.displayInformation({},"","ORA_GROUP_DELETE_ERROR_GROUP_HAS_MEMBERS");else{var u="USERGROUP_DELETE_WITH_MEMBERS_WARNING",c=l.Msg[u]||"Are your sure that you want to delete the usergroup including all members? No member did log in so far.";i("#show-message-confirm").oneWrap("shown.bs.modal",(function(e){i("#confirm").off(),i("#confirm").onWrap("click",(function(e){e.preventDefault(),r.deleteUserGroups(n,(function(e){"ok"===e.rc?d.bootstrapTable("remove",{field:"name",values:n}):s.showMsgOnTop(e.message)}))})),i("#confirmCancel").off(),i("#confirmCancel").onWrap("click",(function(e){e.preventDefault(),i(".modal").modal("hide")}))})),a.displayPopupMessage(u,c,"OK",l.Msg.POPUP_CANCEL)}else r.deleteUserGroups(n,(function(e){"ok"===e.rc?d.bootstrapTable("remove",{field:"name",values:n}):s.showMsgOnTop(e.message)}))}}),"bulk delete usergroup"),i("#backUserGroupList").onWrap("click",(function(){return i("#"+o.getPrevView()).tabWrapShow(),!1}),"closed usergroup view and went back to program view."),d.onWrap("click-row.bs.table",(function(e,t,a){f(t)}),"show usergroup member view"),b=i("#create-user-group"),g=b.find("#user-group-form"),i("#showCreateUserGroupPopup").onWrap("click",(function(){return g.validate(),b.modal("show"),!1})),i("#create-user-group .close-button").onWrap("click",(function(){return b.modal("hide"),!1})),i.validator.addMethod("isValidGroupName",(function(e,t){return""!==e.trim()&&!/[^a-zA-Z0-9=+!?.,%#+&^@_\- ]/gi.test(e.trim())}),l.Msg.ORA_GROUP_ERROR_NAME_INVALID),i.validator.addMethod("isOptionalIntBiggerEquals0Regex",(function(e,t){return/^\d*$/.test(e.trim())}),l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE),i.validator.addMethod("isOptionalOrNotOverThreshold",(function(e,t){return isNaN(e)||""===e.trim()||parseInt(e.trim())<=c}),l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_LIMIT_REACHED),g.removeData("validator"),g.validate({rules:{name:{required:!0,isValidGroupName:!0},initialMembers:{isOptionalIntBiggerEquals0Regex:!0,isOptionalOrNotOverThreshold:!0}},errorClass:"form-invalid",errorPlacement:function(e,t){e.insertBefore(t.parent())},messages:{name:{required:l.Msg.VALIDATION_FIELD_REQUIRED,isValidGroupName:l.Msg.ORA_GROUP_ERROR_NAME_INVALID},initialMembers:{isOptionalIntBiggerEquals0Regex:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,isOptionalOrNotOverThreshold:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_LIMIT_REACHED,min:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,max:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,step:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,number:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE}}}),i("#create-user-group .accept-button").onWrap("click",(function(){var e=g.validate(),t=i("#userGroupNameInput").val(),a=i("#initialMembersInput").val().trim(),s=[],o=new Intl.NumberFormat("en-US",{minimumIntegerDigits:2});if(g.valid()){a=""===a?0:parseInt(a);for(var n=1;n<=a;n++)s.push(o.format(n));return r.createUserGroup(t,s,(function(t){if("ok"===t.rc){var a=d.bootstrapTable("getData");(a=a.map((function(e){return e}))).unshift(t.userGroup),d.bootstrapTable("showLoading"),d.bootstrapTable("removeAll"),d.bootstrapTable("load",a),d.bootstrapTable("hideLoading"),b.modal("hide"),i("#userGroupNameInput").val(""),i("#initialMembersInput").val(0)}else switch(t.cause){case"ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE":case"ORA_GROUP_ADD_MEMBER_ERROR_LIMIT_REACHED":e.showErrors({initialMembers:l.Msg[t.cause]});break;default:e.showErrors({name:l.Msg[t.cause]})}})),!1}})),R=u.find(".reset-password-template"),h=u.find(".action-items-template"),_=u.find(".action-items-header-template"),E=u.find(".edit-member-template"),M={rules:{name:{maxlength:25,loginRegex:!0}},errorClass:"form-invalid",errorPlacement:function(e,t){e.insertBefore(t)},messages:{name:{maxlength:l.Msg.VALIDATION_MAX_LENGTH,loginRegex:l.Msg.VALIDATION_CONTAINS_SPECIAL_CHARACTERS}}},R.remove(),h.remove(),_.remove(),E.remove(),i.validator.addMethod("loginRegex",(function(e,t){return this.optional(t)||/^[a-zA-Z0-9=+!?.,%#+&^@_\- ]+$/gi.test(e)}),l.Msg.VALIDATION_CONTAINS_SPECIAL_CHARACTERS),u.bootstrapTable({locale:o.getLanguage(),theadClasses:"table-dark",height:s.calcDataTableHeight(),pageList:"[ 10, 25, All ]",toolbar:"#userGroupMemberListToolbar",showRefresh:!0,sortName:"account",sortOrder:"asc",showPaginationSwitch:!0,pagination:!0,buttonsAlign:"right",resizable:!0,iconsPrefix:"typcn",buttons:{btnGroupMemberAdd:{html:'<button class="btn" id="showAddMembersPopup" title="'+l.Msg.USERGROUP_MEMBER_CREATE_TOOLTIP+'" type="button" name="btnGroupMemberAdd"><i class="typcn typcn-user-add"></i> </button>'}},btnGroupAdd:{html:'<button class="btn btn-secondary" id="showCreateUserGroupPopup" title="'+l.Msg.USERGROUP_CREATE_TOOLTIP+'" type="button" name="btnGroupAdd"><i class="typcn typcn-plus"></i> </button>'},icons:{paginationSwitchDown:"typcn-document-text",paginationSwitchUp:"typcn-book",refresh:"typcn-refresh"},columns:[{title:"<span lkey='Blockly.Msg.MENU_USER_TOOLTIP'>"+(l.Msg.MENU_USER_TOOLTIP||"User")+"</span>",field:"account",formatter:function(e,t,a){var s=E.find("td").clone(!1),r=e.substr(e.lastIndexOf(":")+1);return s.find(".member-name").text(r),s.find("input").attr("value",r),t.hasDefaultPassword||s.find(".member-name-toggle-button").css("visibility","hidden"),0===t.id&&(E.find(".active").removeClass("active"),s.find(".edit-member-name").addClass("active"),s.find(".member-name-edit-button").addClass("typcn-plus"),s.find(".member-name-edit-button").removeClass("typcn-tick")),0===s.find(".active").length&&s.find(".member-name").addClass("active"),s.html()},events:{"click .member-name-toggle-button":function(e,t,a,s){var r=i(e.target).closest("td"),o=t.substr(t.lastIndexOf(":")+1),n=r.find("input").first().val();void 0===m[s]&&(m[s]=r.find("form").first().validate(M)),r.find(".member-name").hasClass("active")?(r.find(".member-name").removeClass("active"),r.find(".edit-member-name").addClass("active"),r.find(".member-name-column").addClass("active"),i(document.body).onWrap("click",(function(e){0!==i(e.target).closest('tr[data-index="'+s+'"]').length||r.find(".member-name-toggle-button").hasClass("disabled")||0!==i(e.target).closest(".modal").length||(void 0!==n&&""!==n&&n!==o||r.find("input").first().val(o),r.find(".member-name").addClass("active"),r.find(".edit-member-name").removeClass("active"),r.find(".member-name-column").removeClass("active"),i(document.body).off(e))})),r.find("input").first().handleNewSelection()):(r.find(".member-name").addClass("active"),r.find(".edit-member-name").removeClass("active"),r.find(".member-name-column").removeClass("active"))},"dblclick .member-name.active":function(e,t,a,s){var r=i(e.target).closest("td").find(".member-name-toggle-button");!r.is(":visible")||"hidden"===r.css("visibility")||r.hasClass("disabled")||r.prop("disabled")||i(this).closest("td").find(".member-name-toggle-button").clickWrap()},"click .member-name-edit-button":function(e,t,a,s){var o=i(e.target),n=o.closest("td"),d=n.find("input").first(),c=t.substr(t.lastIndexOf(":")+1),p=d.val();void 0===m[s]&&(m[s]=n.find("form").first().validate(M)),i(".member-name-edit-button").closest("td").find("form").valid()&&(void 0!==p&&""!==p&&p!==c||0!==a.id&&i(".member-name-edit-button").closest("td").find(".member-name-toggle-button").clickWrap(),o.addClass("typcn-arrow-sync"),o.removeClass("typcn-tick"),o.addClass("iais-loading-spin"),i(".member-name-edit-button").closest("td").find("input").prop("disabled",!0),i(".member-name-edit-button").closest("td").find(".member-name-toggle-button").addClass("disabled"),r.updateMemberAccount(t,i("#userGroupMemberListHeader").text(),p,(function(e){if("ok"===e.rc)if(0!==a.id){var t=JSON.parse(JSON.stringify(a));t.account=i("#userGroupMemberListHeader").text()+":"+p,delete m[s],u.bootstrapTable("updateRow",{index:s,row:t,replace:!0})}else u.bootstrapTable("append",{id:123,account:i("#userGroupMemberListHeader").text()+":"+p,hasDefaultPassword:!0});else m[s].showErrors({name:l.Msg[e.cause]||e.message}),o.removeClass("iais-loading-spin"),o.addClass("typcn-tick"),o.removeClass("typcn-arrow-sync"),n.find("input").prop("disabled",!1),n.find(".member-name-toggle-button").removeClass("disabled")})))},"keydown input":function(e,t,a,s){if(13===e.originalEvent.keyCode)return e.preventDefault(),i(e.target).closest("td").find(".member-name-edit-button").clickWrap(),!1},"submit form":function(e){return e.preventDefault(),i(e.target).closest("td").find(".member-name-edit-button").clickWrap(),!1}},sortable:!0,sorter:function(e,t){return""===e?1:""===t?-1:e.localeCompare(t)}},{title:"<span lkey='Blockly.Msg.POPUP_PASSWORD'>"+(l.Msg.POPUP_PASSWORD||"Password")+"</span>",field:"password",formatter:function(e,t,a){return 0===t.id&&""===t.account?"":t.hasDefaultPassword?t.account:"************"},sortable:!1,width:"33.3333%"},{title:'<input name="btSelectAll" type="checkbox">',formatter:function(e,t,a){return 0===t.id?"":'<input type="checkbox" name="btSelectItem" data-index="'+a+'">'},valign:"middle",halign:"center",align:"center",width:"37px"},{title:_.find("td").html(),events:{"click .delete":function(e,t,o,n){if(e.stopPropagation(),!i(this).hasClass("disabled")&&o.account){var d=function(e){if(e){var t=e.map((function(e){return e.account}));r.deleteGroupMembers(t[0].split(":",2)[0],t,(function(e){"ok"===e.rc?u.bootstrapTable("remove",{field:"account",values:t}):s.showMsgOnTop(e.message)}))}},c=o.hasDefaultPassword?"DELETE_USERGROUP_MEMBER_WARNING":"DELETE_USERGROUP_MEMBER_AFTER_LOGIN_WARNING",m=l.Msg[c]||"The member you want to delete might have create own programs and did already log in. Are you sure, that you want to delete the member?";i("#show-message-confirm").oneWrap("shown.bs.modal",(function(e){i("#confirm").off(),i("#confirm").onWrap("click",(function(e){e.preventDefault(),d([o])})),i("#confirmCancel").off(),i("#confirmCancel").onWrap("click",(function(e){e.preventDefault(),i(".modal").modal("hide")}))})),a.displayPopupMessage(c,m,"OK",l.Msg.POPUP_CANCEL)}},"click .reset-password":function(e,t,a,o){e.stopPropagation();var n=i(this);!n.hasClass("disabled")&&a.account&&r.setUserGroupMemberDefaultPassword(a.account.split(":",2)[0],a.account,(function(e){"ok"===e.rc?(a.hasDefaultPassword=!0,u.bootstrapTable("updateRow",{index:o,row:a,replace:!0}),n.addClass("disabled")):s.showMsgOnTop(e.message)}))}},align:"left",valign:"top",formatter:function(e,t,a){if(0===t.id&&""===t.account)return"";var s=h.clone(!0);if(t.hasDefaultPassword){var r=s.find(".reset-password");r.addClass("disabled"),r.attr("data-status","disabled")}return n.translate(s),s.find("td").html()},width:"117px"}]}),i("#userGroupMemberList").find('[data-bs-toggle="tooltip"]').tooltip(),u.bootstrapTable("togglePagination"),n.translate(i("#userGroupMemberList")),i(window).resize((function(){u.bootstrapTable("resetView",{height:s.calcDataTableHeight()})})),u.closest("#userGroupMemberList").find('button[name="refresh"]').onWrap("click",(function(e){e.preventDefault();var t=i("#userGroupMemberListHeader").text();u.bootstrapTable("showLoading"),r.loadUserGroup(t,(function(e){"ok"===e.rc&&void 0!==e.userGroup&&void 0!==e.userGroup.members?(e.userGroup.members.push({id:0,account:"",hasDefaultPassword:!1}),u.bootstrapTable("load",e.userGroup.members),m={}):(u.bootstrapTable("removeAll"),a.displayInformation(e,e.cause,e.cause)),setTimeout((function(){u.bootstrapTable("resetView",{height:s.calcDataTableHeight()}),u.bootstrapTable("hideLoading")}),250)}))}),"refreshed usergroup member view"),u.onWrap("check-all.bs.table",(function(e,t){u.closest("#userGroupMemberList").find(".deleteSome").removeClass("disabled"),t.reduce((function(e,t){return e||!t.hasDefaultPassword}),!1)&&u.closest("#userGroupMemberList").find(".resetPasswords").removeClass("disabled"),u.find(".delete, .reset-password").addClass("disabled")}),"check all usergroups"),u.onWrap("check.bs.table",(function(e,t,a){u.closest("#userGroupMemberList").find(".deleteSome").removeClass("disabled"),t.hasDefaultPassword||u.closest("#userGroupMemberList").find(".resetPasswords").removeClass("disabled"),u.find(".delete, .reset-password").addClass("disabled")}),"check one usergroup"),u.onWrap("uncheck-all.bs.table",(function(e,t){u.closest("#userGroupMemberList").find(".deleteSome, .resetPasswords").addClass("disabled"),u.find(".delete, .reset-password").filter(':not([data-status="disabled"])').removeClass("disabled")}),"uncheck all usergroups"),u.onWrap("uncheck.bs.table",(function(e,t,a){var s=u.bootstrapTable("getSelections");if(s&&0!==s.length){var r=s.reduce((function(e,t){return e||!t.hasDefaultPassword}),!1);r||u.closest("#userGroupMemberList").find(".resetPasswords").addClass("disabled")}else u.closest("#userGroupMemberList").find(".deleteSome, .resetPasswords").addClass("disabled"),u.find(".delete, .reset-password").filter(':not([data-status="disabled"])').removeClass("disabled")}),"uncheck one usergroup"),u.closest("#userGroupMemberList").find(".deleteSome").onWrap("click",(function(){var e=u.bootstrapTable("getSelections"),t=u.closest("#userGroupMemberList").find(".deleteSome");if(e&&0!==e.length&&!t.hasClass("disabled")){var o=e.reduce((function(e,t){return e&&t.hasDefaultPassword}),!0),n=function(e){if(e){var t=e.map((function(e){return e.account}));r.deleteGroupMembers(t[0].split(":",2)[0],t,(function(e){"ok"===e.rc?u.bootstrapTable("remove",{field:"account",values:t}):s.showMsgOnTop(e.message)}))}},d=o?"DELETE_USERGROUP_MEMBER_WARNING":"DELETE_USERGROUP_MEMBER_AFTER_LOGIN_WARNING",c=l.Msg[d]||"The member you want to delete might have create own programs and did already log in. Are you sure, that you want to delete the member?";i("#show-message-confirm").oneWrap("shown.bs.modal",(function(t){i("#confirm").off(),i("#confirm").onWrap("click",(function(t){t.preventDefault(),n(e)})),i("#confirmCancel").off(),i("#confirmCancel").onWrap("click",(function(e){e.preventDefault(),i(".modal").modal("hide")}))})),a.displayPopupMessage(d,c,"OK",l.Msg.POPUP_CANCEL)}}),"Bulk removed members of usergroup."),u.closest("#userGroupMemberList").find(".resetPasswords").onWrap("click",(function(){var e=u.bootstrapTable("getSelections"),t=u.closest("#userGroupMemberList").find(".resetPasswords");if(e&&0!==e.length&&!t.hasClass("disabled")){var a=e[0].account.split(":",2)[0],o=e.filter((function(e){return!e.hasDefaultPassword})).map((function(e){return e.account}));r.setUserGroupMemberDefaultPasswords(a,o,(function(e){"ok"===e.rc?u.closest("#userGroupMemberList").find('button[name="refresh"]').clickWrap():s.showMsgOnTop(e.message)}))}}),"Bulk resetted passwords of usergroup members."),i("#backUserGroupMemberList").onWrap("click",(function(){return p(),!1})),function(){var e=i("#user-group-add-members"),t=e.find("form"),a=t.find("#additionalMembersInput");e.find('label[for="additionalMembersInput"] ~ .hint');i("#showAddMembersPopup").onWrap("click",(function(){return t.validate(),e.modal("show"),!1})),e.find(".close-button").clickWrap((function(){return e.modal("hide"),!1})),i.validator.addMethod("isIntBiggerThan1Regex",(function(e,t){return/^\s*0*[1-9]\d*\s*$/.test(e.trim())}),l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE),i.validator.addMethod("notOverThreshold",(function(e,t){return!isNaN(e)&&u.bootstrapTable("getData").length-1+parseInt(e.trim())<=c}),l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_LIMIT_REACHED),t.removeData("validator"),t.validate({rules:{additionalMembers:{required:!0,isIntBiggerThan1Regex:!0,notOverThreshold:!0}},errorClass:"form-invalid",errorPlacement:function(e,t){e.insertBefore(t.parent())},messages:{additionalMembers:{required:l.Msg.VALIDATION_FIELD_REQUIRED,isIntBiggerThan1Regex:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,notOverThreshold:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_LIMIT_REACHED,min:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,max:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,step:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE,number:l.Msg.ORA_GROUP_ADD_MEMBER_ERROR_SMALLER_THAN_ONE}}}),t.submit((function(t){return t.preventDefault(),e.find(".accept-button").clickWrap(),!1})),a.keydown((function(t){if(13===t.originalEvent.keyCode)return t.stopPropagation(),t.preventDefault(),e.find(".accept-button").clickWrap(),!1})),e.find(".accept-button").onWrap("click",(function(){var s=t.validate();if(t.valid()){for(var o=parseInt(a.val().trim()),n=[],d=new Intl.NumberFormat("en-US",{minimumIntegerDigits:2}),c=0,m=i("#userGroupMemberListHeader").text().trim(),p=(c=u.bootstrapTable("getData").reduce((function(e,t){if(null===t||0===t.id)return e;var a=t.account.substr(t.account.indexOf(":")+1);return isNaN(a)?e:(a=parseInt(a),Math.max(e,a))}),c))+1;p<=c+o;p++)n.push(d.format(p));return r.addGroupMembers(m,n,(function(t){"ok"===t.rc?(e.modal("hide"),a.val(""),t.userGroup&&f(t.userGroup)):s.showErrors({additionalMembers:l.Msg[t.cause]})})),!1}}))}()}}));
//# sourceMappingURL=userGroup.controller.js.map
//# sourceMappingURL=userGroup.controller.js.map
